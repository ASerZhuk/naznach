(()=>{var e={};e.id=663,e.ids=[663],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},71017:e=>{"use strict";e.exports=require("path")},57310:e=>{"use strict";e.exports=require("url")},17405:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>d,routeModule:()=>x,tree:()=>c}),r(63996),r(32029),r(35866);var s=r(23191),a=r(88716),i=r(37922),n=r.n(i),l=r(95231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);r.d(t,o);let c=["",{children:["perezapis",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,63996)),"D:\\Projects\\NEWWEBAPPTELEGA\\web-app\\src\\app\\perezapis\\[id]\\page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,32029)),"D:\\Projects\\NEWWEBAPPTELEGA\\web-app\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["D:\\Projects\\NEWWEBAPPTELEGA\\web-app\\src\\app\\perezapis\\[id]\\page.tsx"],p="/perezapis/[id]/page",u={require:r,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/perezapis/[id]/page",pathname:"/perezapis/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},68080:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,12994,23)),Promise.resolve().then(r.t.bind(r,96114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,79671,23)),Promise.resolve().then(r.t.bind(r,41868,23)),Promise.resolve().then(r.t.bind(r,84759,23))},95528:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,44064,23))},32495:(e,t,r)=>{Promise.resolve().then(r.bind(r,49762)),Promise.resolve().then(r.bind(r,73210))},49762:(e,t,r)=>{"use strict";r.d(t,{default:()=>a});var s=r(10326);r(17577);let a=({children:e})=>s.jsx(s.Fragment,{children:s.jsx("div",{className:"max-w-[2520px] min-h-screen mx-auto xl:px-20 md:px-10 sm:px-2 px-4",children:e})})},73210:(e,t,r)=>{"use strict";r.d(t,{default:()=>m});var s,a=r(10326),i=r(49762),n=r(91958),l=r(7373),o=r(35047),c=r(17577),d=r(67762);r(82094),r(73920);var p=r(46951),u=r(42163),x=r(31190);r(45996),(0,d.I2)("ru",l.ru),function(e){e[e.DATE=0]="DATE"}(s||(s={}));let m=({user:e,garfik:t,appointments:r})=>{let s;let l=(0,o.useRouter)(),[m,h]=(0,c.useState)(0),[f,P]=(0,c.useState)(null),[g,y]=(0,c.useState)([]),[j,v]=(0,c.useState)(null),[b,w]=(0,c.useState)(),[E,A]=(0,c.useState)({firstName:"",lastName:"",phone:""}),N=f?(0,p.WU)(f,"dd.MM.yyyy"):null;(0,c.useEffect)(()=>{let r=window.Telegram.WebApp;r.ready();let s=r.initDataUnsafe?.user;w(s?.id),(async()=>{if(f){let r=f.getDay(),s=t.find(e=>e.dayOfWeek===r);if(s)try{let t=await fetch(`/api/appointments?specialistId=${e?.userId}&date=${N}`);if(t.ok){let e=await t.json();if(Array.isArray(e)){let t=e.map(e=>e.time),r=s.time.filter(e=>!t.includes(e));y(r)}else console.error("Ответ от API не является массивом:",e),y([])}else console.error("Ошибка при загрузке записей"),y([])}catch(e){console.error("Ошибка при загрузке записей:",e),y([])}else y([])}})()},[f,t]);let W=e=>{v(e)},D=async()=>{try{let e=await fetch(`/api/appointments?id=${r.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:N,time:j})});if(!e.ok)throw Error("Ошибка при создании записи");let t=await e.json();console.log("Запись успешно перезаписана:",t),x.Am.success("Запись перезаписана успешно"),l.push("/")}catch(e){console.error("Ошибка при перезаписи записи:",e)}};return 0===m&&(s=(0,a.jsxs)(a.Fragment,{children:[a.jsx(n.xE,{onClick:()=>{l.back()}}),a.jsx(n.c7,{text:"Перезаписать",onClick:D}),a.jsx(x.Ix,{}),(0,a.jsxs)("div",{className:"flex-col bg-white rounded-lg shadow-md p-6 text-xl flex justify-center",children:[(0,a.jsxs)("div",{className:"border-b pb-4",children:[a.jsx("h2",{className:"text-xl font-normal mb-2",children:"Выбери дату и время"}),a.jsx("span",{className:"text-sm pb-2",children:"Выбери актуальную для тебя дату и время для записи на услугу"})]}),a.jsx("div",{className:"mt-4 flex justify-center",children:a.jsx(d.ZP,{selected:f,onChange:e=>P(e),filterDate:e=>{let r=e.getDay();return t.some(e=>e.dayOfWeek===r)},minDate:new Date,maxDate:(0,u.z)(new Date,1),locale:"ru",inline:!0,className:"datepicker-custom"})}),f&&a.jsx("div",{className:"mt-4 p-6",children:a.jsx("div",{className:"grid grid-cols-4 gap-4 place-items-center text-sm",children:g.length>0?g.map((e,t)=>a.jsx("button",{onClick:()=>W(e),className:`px-3 py-2 rounded-full ${j===e?"bg-blue-500 text-white":"bg-gray-200 hover:bg-gray-300"}`,children:e},t)):a.jsx("p",{children:"Нет доступного времени"})})})]})]})),a.jsx(i.default,{children:a.jsx("div",{children:s})})}},59055:(e,t,r)=>{"use strict";r.d(t,{W:()=>a});let s=new(r(53524)).PrismaClient;async function a(e){try{return await s.timeSlots.findMany({where:{specialistId:e}})}catch(e){return console.error("Ошибка при загрузке графика специалиста:",e),null}}},58873:(e,t,r)=>{"use strict";r.d(t,{x:()=>a});let s=new(r(53524)).PrismaClient;async function a(e){try{return await s.specialist.findFirst({where:{userId:e}})}catch(e){return console.error("Ошибка при загрузке графика специалиста:",e),null}}},84443:(e,t,r)=>{"use strict";r.d(t,{ZP:()=>l});var s=r(68570);let a=(0,s.createProxy)(String.raw`D:\Projects\NEWWEBAPPTELEGA\web-app\src\app\components\Container.tsx`),{__esModule:i,$$typeof:n}=a;a.default;let l=(0,s.createProxy)(String.raw`D:\Projects\NEWWEBAPPTELEGA\web-app\src\app\components\Container.tsx#default`)},32029:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o,metadata:()=>l});var s=r(19510),a=r(25384),i=r.n(a);r(5023),r(83952);var n=r(9720);let l={title:"Create Next App",description:"Generated by create next app"};function o({children:e}){return(0,s.jsxs)("html",{lang:"en",children:[(0,s.jsxs)("head",{children:[s.jsx(n.default,{strategy:"beforeInteractive",src:"https://telegram.org/js/telegram-web-app.js"}),s.jsx(n.default,{strategy:"beforeInteractive",src:"https://cdn.jsdelivr.net/npm/eruda"})]}),s.jsx("body",{className:i().className,children:s.jsx("div",{className:"pb-6 pt-6 bg-slate-100",children:e})})]})}},63996:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m});var s=r(19510);r(71159);var a=r(58873),i=r(59055),n=r(84443);let l=new(r(53524)).PrismaClient;async function o(e){try{let t=parseInt(e,10);if(isNaN(t))throw Error("Invalid ID");return await l.appointments.findUnique({where:{id:t}})}catch(e){return console.error("Ошибка при загрузке записи:",e),null}}var c=r(68570);let d=(0,c.createProxy)(String.raw`D:\Projects\NEWWEBAPPTELEGA\web-app\src\app\perezapis\[id]\client.tsx`),{__esModule:p,$$typeof:u}=d;d.default;let x=(0,c.createProxy)(String.raw`D:\Projects\NEWWEBAPPTELEGA\web-app\src\app\perezapis\[id]\client.tsx#default`),m=async({params:e})=>{let t=await o(e.id.toString());if(!t)return s.jsx("div",{children:"Запись не найдена"});let r=await (0,a.x)(t.specialistId);if(!r)return s.jsx("div",{children:"Пользователь не найден"});if(!t.specialistId)return s.jsx("div",{children:"Специалист не найден"});let l=await (0,i.W)(t.specialistId)||[];return s.jsx(n.ZP,{children:s.jsx(x,{garfik:l,user:r,appointments:t})})}},73881:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});var s=r(66621);let a=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,s.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]},5023:()=>{},73920:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[948,206,339,689,609],()=>r(17405));module.exports=s})();
(()=>{var e={};e.id=672,e.ids=[672],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},71017:e=>{"use strict";e.exports=require("path")},57310:e=>{"use strict";e.exports=require("url")},93714:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>m,pages:()=>d,routeModule:()=>x,tree:()=>o}),s(31746),s(32029),s(35866);var a=s(23191),r=s(88716),n=s(37922),i=s.n(n),l=s(95231),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);s.d(t,c);let o=["",{children:["zapis",{children:["[userId]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,31746)),"D:\\Projects\\NEWWEBAPPTELEGA\\web-app\\src\\app\\zapis\\[userId]\\page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,32029)),"D:\\Projects\\NEWWEBAPPTELEGA\\web-app\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["D:\\Projects\\NEWWEBAPPTELEGA\\web-app\\src\\app\\zapis\\[userId]\\page.tsx"],m="/zapis/[userId]/page",p={require:s,loadChunk:()=>Promise.resolve()},x=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/zapis/[userId]/page",pathname:"/zapis/[userId]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},68080:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,12994,23)),Promise.resolve().then(s.t.bind(s,96114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,79671,23)),Promise.resolve().then(s.t.bind(s,41868,23)),Promise.resolve().then(s.t.bind(s,84759,23))},95528:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,44064,23))},84353:(e,t,s)=>{Promise.resolve().then(s.bind(s,49762)),Promise.resolve().then(s.bind(s,82303))},49762:(e,t,s)=>{"use strict";s.d(t,{default:()=>r});var a=s(10326);s(17577);let r=({children:e})=>a.jsx(a.Fragment,{children:a.jsx("div",{className:"max-w-[2520px] min-h-screen mx-auto xl:px-20 md:px-10 sm:px-2 px-4",children:e})})},82303:(e,t,s)=>{"use strict";s.d(t,{default:()=>j});var a,r=s(10326),n=s(49762),i=s(91958),l=s(7373),c=s(35047),o=s(17577),d=s(67762);s(82094),s(45325);var m=s(46951),p=s(42163),x=s(47100),u=s(94835),h=s(31190);s(45996);var f=s(74034);function b(e){return(0,f.w_)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"g",attr:{id:"Calendar_Date"},child:[{tag:"path",attr:{d:"M18.435,4.955h-1.94v-1.41c0-0.26-0.23-0.51-0.5-0.5c-0.27,0.01-0.5,0.22-0.5,0.5v1.41h-7v-1.41\n            c0-0.26-0.23-0.51-0.5-0.5c-0.27,0.01-0.5,0.22-0.5,0.5v1.41h-1.93c-1.38,0-2.5,1.12-2.5,2.5v11c0,1.38,1.12,2.5,2.5,2.5h12.87\n            c1.38,0,2.5-1.12,2.5-2.5v-11C20.935,6.075,19.815,4.955,18.435,4.955z M19.935,18.455c0,0.83-0.67,1.5-1.5,1.5H5.565\n            c-0.83,0-1.5-0.67-1.5-1.5v-8.42h15.87V18.455z M19.935,9.035H4.065v-1.58c0-0.83,0.67-1.5,1.5-1.5h1.93v0.59\n            c0,0.26,0.23,0.51,0.5,0.5c0.27-0.01,0.5-0.22,0.5-0.5v-0.59h7v0.59c0,0.26,0.23,0.51,0.5,0.5c0.27-0.01,0.5-0.22,0.5-0.5v-0.59\n            h1.94c0.83,0,1.5,0.67,1.5,1.5V9.035z"},child:[]},{tag:"path",attr:{d:"M11.492,17.173v-3.46c0-0.059-0.064-0.095-0.114-0.064l-0.638,0.392\n            c-0.1,0.061-0.228-0.01-0.228-0.128v-0.651c0-0.105,0.055-0.203,0.146-0.257l0.764-0.457c0.047-0.028,0.1-0.043,0.154-0.043h0.626\n            c0.166,0,0.3,0.134,0.3,0.3v4.367c0,0.166-0.134,0.3-0.3,0.3h-0.409C11.626,17.473,11.492,17.339,11.492,17.173z"},child:[]}]}]})(e)}(0,d.I2)("ru",l.ru),function(e){e[e.DATE=0]="DATE",e[e.INFO=1]="INFO",e[e.CONF=2]="CONF"}(a||(a={}));let j=({user:e,garfik:t})=>{let s;let a=(0,c.useRouter)(),[l,f]=(0,o.useState)(0),[j,g]=(0,o.useState)(null),[v,N]=(0,o.useState)([]),[y,w]=(0,o.useState)(null),[P,E]=(0,o.useState)(),[A,C]=(0,o.useState)({firstName:"",lastName:"",phone:""}),I=j?(0,m.WU)(j,"dd.MM.yyyy"):null,k=()=>{f(e=>e+1)},W=()=>{f(e=>e-1)};(0,o.useEffect)(()=>{let s=window.Telegram.WebApp;s.ready();let a=s.initDataUnsafe?.user;E(a?.id),(async()=>{if(j){let s=j.getDay(),a=t.find(e=>e.dayOfWeek===s);if(a)try{let t=await fetch(`/api/appointments?specialistId=${e?.userId}&date=${I}`);if(t.ok){let e=await t.json();if(Array.isArray(e)){let t=e.map(e=>e.time),s=a.time.filter(e=>!t.includes(e));N(s)}else console.error("Ответ от API не является массивом:",e),N([])}else console.error("Ошибка при загрузке записей"),N([])}catch(e){console.error("Ошибка при загрузке записей:",e),N([])}else N([])}})()},[j,t]);let z=e=>{w(e)},_=e=>{let{name:t,value:s}=e.target;C({...A,[t]:s})},D=async()=>{try{let t=await fetch("/api/appointments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firstName:A.firstName,lastName:A.lastName,phone:A.phone,specialistId:e.userId,clientId:P?.toString(),date:I,time:y,specialistName:e.firstName,specialistLastName:e.lastName,specialistPhone:e.phone,specialistCategory:e.category,specialistAddress:e.address,specialistPrice:e.price})});if(!t.ok)throw Error("Ошибка при создании записи");let s=await t.json();console.log("Запись успешно создана:",s),h.Am.success("Запись прошла успешно"),a.push("/")}catch(e){console.error("Ошибка при создании записи:",e)}};return 0===l&&(s=(0,r.jsxs)(r.Fragment,{children:[r.jsx(i.xE,{onClick:()=>{a.back()}}),r.jsx(i.c7,{text:"Далее",onClick:k}),(0,r.jsxs)("div",{className:"flex-col bg-white rounded-lg shadow-md p-6 text-xl flex justify-center",children:[(0,r.jsxs)("div",{className:"border-b pb-4",children:[r.jsx("h2",{className:"text-xl font-normal mb-2",children:"Выбери дату и время"}),r.jsx("span",{className:"text-sm pb-2",children:"Выбери актуальную для тебя дату и время для записи на услугу"})]}),r.jsx("div",{className:"mt-4 flex justify-center",children:r.jsx(d.ZP,{selected:j,onChange:e=>g(e),filterDate:e=>{let s=e.getDay();return t.some(e=>e.dayOfWeek===s)},minDate:new Date,maxDate:(0,p.z)(new Date,1),locale:"ru",inline:!0,className:"datepicker-custom"})}),j&&r.jsx("div",{className:"mt-4 p-6",children:r.jsx("div",{className:"grid grid-cols-4 gap-4 place-items-center text-sm",children:v.length>0?v.map((e,t)=>r.jsx("button",{onClick:()=>z(e),className:`px-3 py-2 rounded-full ${y===e?"bg-blue-500 text-white":"bg-gray-200 hover:bg-gray-300"}`,children:e},t)):r.jsx("p",{children:"Нет доступного времени"})})})]})]})),1===l&&(s=(0,r.jsxs)(r.Fragment,{children:[r.jsx(i.xE,{onClick:W}),r.jsx(i.c7,{text:"Далее",onClick:k}),(0,r.jsxs)("div",{className:"max-w-md mx-auto bg-white shadow-md rounded-lg p-6",children:[(0,r.jsxs)("div",{className:" border-b pb-4 mb-4",children:[r.jsx("h2",{className:"text-xl font-normal mb-2",children:"Информация"}),r.jsx("span",{className:"text-sm",children:"Введи необходимые данные"})]}),(0,r.jsxs)("form",{children:[r.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"firstName",children:"Имя"}),r.jsx("input",{id:"firstName",name:"firstName",type:"text",placeholder:"Введите имя",value:A.firstName,onChange:_,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline mb-6 text-sm"}),r.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"lastName",children:"Фамилия"}),r.jsx("input",{id:"lastName",name:"lastName",type:"text",placeholder:"Введите фамилию",value:A.lastName,onChange:_,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline mb-6 text-sm"}),r.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"phone",children:"Телефон"}),r.jsx("input",{id:"phone",name:"phone",type:"tel",placeholder:"Введите телефон",value:A.phone,onChange:_,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline text-sm"})]})]})]})),2===l&&(s=(0,r.jsxs)(r.Fragment,{children:[r.jsx(i.xE,{onClick:W}),r.jsx(i.c7,{text:"Записаться",onClick:D}),(0,r.jsxs)("div",{className:"flex flex-col bg-white rounded-lg shadow-md p-6 text-xl",children:[r.jsx(h.Ix,{}),(0,r.jsxs)("div",{className:" border-b pb-4 mb-4",children:[r.jsx("h2",{className:"text-xl font-normal mb-2",children:"Проверь данные"}),r.jsx("span",{className:"text-sm pb-4",children:"Если данные введены верно записывайся на услугу"})]}),(0,r.jsxs)("div",{className:"border-b flex items-center justify-between mt-4 p-2 text-sm",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(x.Mlo,{size:32,className:"bg-green-500 rounded-lg p-1",color:"white"}),r.jsx("span",{className:"ml-2 font-semibold",children:"Имя и Фамилия"})]}),(0,r.jsxs)("div",{children:[A.firstName," ",A.lastName]})]}),(0,r.jsxs)("div",{className:"border-b flex items-center justify-between mt-4 p-2 text-sm",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(u.X_f,{size:32,className:"bg-cyan-500 rounded-lg p-1",color:"white"}),r.jsx("span",{className:"ml-2 font-semibold",children:"Номер телефона"})]}),r.jsx("div",{children:A.phone})]}),(0,r.jsxs)("div",{className:"border-b flex items-center justify-between mt-4 p-2 text-sm",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(b,{size:32,className:"bg-red-500 rounded-lg p-1",color:"white"}),r.jsx("span",{className:"ml-2 font-semibold",children:"Дата записи"})]}),r.jsx("div",{children:I})]}),(0,r.jsxs)("div",{className:"border-b flex items-center justify-between mt-4 p-2 text-sm",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(u.Cl8,{size:32,className:"bg-orange-500 rounded-lg p-1",color:"white"}),r.jsx("span",{className:"ml-2 font-semibold",children:"Время записи"})]}),r.jsx("div",{children:y})]}),(0,r.jsxs)("div",{className:"border-b flex items-center justify-between mt-4 p-2 text-sm",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(x.R_H,{size:32,className:"bg-yellow-500 rounded-lg p-1",color:"white"}),r.jsx("span",{className:"ml-2 font-semibold",children:"Стоимость"})]}),(0,r.jsxs)("div",{children:[e.price," руб."]})]})]})]})),r.jsx(n.default,{children:r.jsx("div",{children:s})})}},59055:(e,t,s)=>{"use strict";s.d(t,{W:()=>r});let a=new(s(53524)).PrismaClient;async function r(e){try{return await a.timeSlots.findMany({where:{specialistId:e}})}catch(e){return console.error("Ошибка при загрузке графика специалиста:",e),null}}},58873:(e,t,s)=>{"use strict";s.d(t,{x:()=>r});let a=new(s(53524)).PrismaClient;async function r(e){try{return await a.specialist.findFirst({where:{userId:e}})}catch(e){return console.error("Ошибка при загрузке графика специалиста:",e),null}}},84443:(e,t,s)=>{"use strict";s.d(t,{ZP:()=>l});var a=s(68570);let r=(0,a.createProxy)(String.raw`D:\Projects\NEWWEBAPPTELEGA\web-app\src\app\components\Container.tsx`),{__esModule:n,$$typeof:i}=r;r.default;let l=(0,a.createProxy)(String.raw`D:\Projects\NEWWEBAPPTELEGA\web-app\src\app\components\Container.tsx#default`)},32029:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c,metadata:()=>l});var a=s(19510),r=s(25384),n=s.n(r);s(5023),s(83952);var i=s(9720);let l={title:"Create Next App",description:"Generated by create next app"};function c({children:e}){return(0,a.jsxs)("html",{lang:"en",children:[(0,a.jsxs)("head",{children:[a.jsx(i.default,{strategy:"beforeInteractive",src:"https://telegram.org/js/telegram-web-app.js"}),a.jsx(i.default,{strategy:"beforeInteractive",src:"https://cdn.jsdelivr.net/npm/eruda"})]}),a.jsx("body",{className:n().className,children:a.jsx("div",{className:"pb-6 pt-6 bg-slate-100",children:e})})]})}},31746:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var a=s(19510);s(71159);var r=s(68570);let n=(0,r.createProxy)(String.raw`D:\Projects\NEWWEBAPPTELEGA\web-app\src\app\zapis\[userId]\client.tsx`),{__esModule:i,$$typeof:l}=n;n.default;let c=(0,r.createProxy)(String.raw`D:\Projects\NEWWEBAPPTELEGA\web-app\src\app\zapis\[userId]\client.tsx#default`);var o=s(58873),d=s(59055),m=s(84443);let p=async({params:e})=>{let t=await (0,o.x)(e.userId),s=await (0,d.W)(e.userId);return t?a.jsx(m.ZP,{children:a.jsx(c,{user:t,garfik:s??[]})}):a.jsx("div",{children:"Пользователь не найден"})}},73881:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var a=s(66621);let r=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,a.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]},5023:()=>{},45325:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[948,206,339,835,689,100,609],()=>s(93714));module.exports=a})();
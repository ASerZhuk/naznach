(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[878],{70082:function(e,s,l){Promise.resolve().then(l.bind(l,92119)),Promise.resolve().then(l.bind(l,36689))},92119:function(e,s,l){"use strict";var t=l(57437);l(2265),s.default=e=>{let{children:s}=e;return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("div",{className:"max-w-[2520px] min-h-screen mx-auto xl:px-20 md:px-10 sm:px-2 px-4",children:s})})}},55418:function(e,s,l){"use strict";var t=l(2265);s.Z=()=>{let[e,s]=(0,t.useState)(null),[l,i]=(0,t.useState)(),[r,a]=(0,t.useState)(!0),[c,n]=(0,t.useState)(null);return(0,t.useEffect)(()=>{var e;let l=window.Telegram.WebApp;l.ready();let t=null===(e=l.initDataUnsafe)||void 0===e?void 0:e.user;if(t){s(t);let e="6874087551:AAHHCPMYy9JXgHVBavUdce_YjoXWgd0Fuew";fetch("https://api.telegram.org/bot".concat(e,"/getUserProfilePhotos?user_id=").concat(t.id)).then(e=>{if(!e.ok)throw Error("Ошибка получения данных от Telegram API");return e.json()}).then(s=>{var l,t;if((null==s?void 0:null===(t=s.result)||void 0===t?void 0:null===(l=t.photos)||void 0===l?void 0:l.length)>0){let l=s.result.photos[0][0].file_id;return fetch("https://api.telegram.org/bot".concat(e,"/getFile?file_id=").concat(l))}throw Error("Фотографии профиля не найдены")}).then(e=>{if(!e.ok)throw Error("Ошибка получения файла с Telegram API");return e.json()}).then(s=>{var l;if(null==s?void 0:null===(l=s.result)||void 0===l?void 0:l.file_path)i("https://api.telegram.org/file/bot".concat(e,"/").concat(s.result.file_path));else throw Error("Путь к файлу не найден")}).catch(e=>{console.error("Ошибка получения фото профиля:",e),n(e.message),i("/placeholder-image.jpg")}).finally(()=>a(!1))}else a(!1)},[]),{telegram_user:e,userPhoto:l,loading:r,error:c}}},36689:function(e,s,l){"use strict";var t=l(57437),i=l(55418),r=l(48769),a=l(58710),c=l(9851),n=l(61572),d=l(16463),o=l(2265),m=l(41942),h=l(16356),x=l(23580);l(44193),s.default=e=>{let{appointment:s}=e,l=(0,d.useRouter)(),{telegram_user:u,userPhoto:p}=(0,i.Z)(),[j,f]=(0,o.useState)(s||[]),[N,v]=(0,o.useState)(!1),[g,b]=(0,o.useState)(""),[w,y]=(0,o.useState)(null);(0,o.useEffect)(()=>{let e=window.Telegram.WebApp;e.ready(),e.BackButton.show(),e.BackButton.onClick(()=>l.push("/")),e.MainButton.hide(),s&&s.length>0&&f([...s].reverse())},[s]);let k=async()=>{if(!g.trim()){x.Am.error("Пожалуйста, укажите причину отмены");return}if(null!==w)try{(await fetch("/api/appointments?id=".concat(w),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({reason:g})})).ok?(f(e=>e.filter(e=>e.id!==w)),x.Am.success("Запись успешно отменена"),v(!1)):x.Am.error("Не удалось отменить запись")}catch(e){console.error("Ошибка при отмене записи:",e),x.Am.error("Произошла ошибка при отмене записи")}},_=e=>{y(e),b(""),v(!0)};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.Ix,{}),(0,t.jsx)(r.Z,{title:"Причина отмены",visible:N,onOk:k,onCancel:()=>v(!1),okText:"Подтвердить",cancelText:"Отмена",children:(0,t.jsx)(a.Z,{value:g,onChange:e=>b(e.target.value),placeholder:"Введите причину отмены"})}),(0,t.jsxs)("div",{className:"bg-white shadow-md rounded-lg flex items-center justify-between mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"p-2",children:(0,t.jsx)(c.C,{src:p,size:48})}),(0,t.jsx)("div",{className:"pl-2 font-medium",children:null==u?void 0:u.first_name})]}),(0,t.jsx)("div",{className:"pr-2",children:(0,t.jsx)(n.Z,{width:150,src:"/logo.svg"})})]}),(0,t.jsxs)("div",{className:"max-w-md mx-auto bg-white shadow-md rounded-lg p-6",children:[(0,t.jsxs)("div",{className:" border-b pb-4",children:[(0,t.jsx)("h2",{className:"text-xl pb-2 font-normal",children:"Мои записи"}),(0,t.jsx)("span",{className:"text-sm",children:"Актуальные и прошедшие записи"})]}),(0,t.jsx)("div",{children:j&&j.length>0?j.map(e=>(0,t.jsxs)("div",{className:"mt-4 p-4 border-b",children:[(0,t.jsxs)("div",{className:"mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center mb-1",children:[(0,t.jsx)(h.FFD,{size:24,className:"bg-blue-500 p-1 rounded-lg mr-2",color:"white"}),(0,t.jsx)("div",{className:"mr-2",children:"Дата:"}),(0,t.jsx)("span",{className:"font-semibold",children:e.date})]}),(0,t.jsxs)("div",{className:"flex items-center mb-1",children:[(0,t.jsx)(h.iNe,{size:24,className:"bg-red-500 p-1 rounded-lg mr-2",color:"white"}),(0,t.jsx)("div",{className:"mr-2",children:"Время:"}),(0,t.jsx)("span",{className:"font-semibold",children:e.time})]}),e.specialistPrice&&(0,t.jsxs)("div",{className:"flex items-center mb-1",children:[(0,t.jsx)(h.DkQ,{size:24,className:"bg-green-500 p-1 rounded-lg mr-2",color:"white"}),(0,t.jsx)("div",{className:"mr-2",children:"Цена:"}),(0,t.jsxs)("span",{className:"font-semibold",children:[e.specialistPrice," ₽"]})]}),e.specialistCategory&&(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(h.dwX,{size:24,className:"bg-orange-500 p-1 rounded-lg mr-2",color:"white"}),(0,t.jsx)("div",{className:"mr-2",children:"Категория:"}),(0,t.jsx)("span",{className:"font-semibold",children:e.specialistCategory})]})]}),(0,t.jsxs)("div",{className:"",children:[(0,t.jsxs)("div",{className:"flex items-center mb-1",children:[(0,t.jsx)(h.Vyx,{size:24,className:"bg-blue-500 p-1 rounded-lg mr-2",color:"white"}),(0,t.jsx)("div",{className:"mr-2",children:"Мастер:"}),(0,t.jsxs)("span",{className:"font-semibold",children:[e.specialistName," ",e.specialistLastName]})]}),(0,t.jsxs)("div",{className:"flex items-center mb-1",children:[(0,t.jsx)(h.IXo,{size:24,className:"bg-red-500 p-1 rounded-lg mr-2",color:"white"}),(0,t.jsx)("div",{className:"mr-2",children:"Телефон:"}),(0,t.jsx)("span",{className:"font-semibold",children:e.specialistPhone})]}),e.specialistAddress&&(0,t.jsxs)("div",{className:"flex items-center mb-1",children:[(0,t.jsx)(h.$0r,{size:24,className:"bg-orange-500 p-1 rounded-lg mr-2",color:"white"}),(0,t.jsx)("div",{className:"mr-2",children:"Адрес:"}),(0,t.jsx)("span",{className:"font-semibold",children:e.specialistAddress})]})]}),(0,t.jsxs)("div",{className:"flex justify-center",children:[(0,t.jsx)("div",{className:"text-center pt-2 mt-2",children:(0,t.jsx)("button",{onClick:()=>l.push("/perezapis/".concat(e.id)),className:"bg-green-500 rounded-full px-5 py-3 mt-4 text-white text-sm",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(m.ffH,{className:"mr-2"}),"Перезаписать"]})})}),(0,t.jsx)("div",{className:"text-center pt-2 mt-2 ml-4",children:(0,t.jsx)("button",{onClick:()=>_(e.id),className:"bg-red-500 rounded-full px-9 py-3 mt-4 text-white text-sm",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(h.xg7,{className:"mr-2"}),"Отменить"]})})})]})]},e.id)):(0,t.jsx)("p",{className:"text-center",children:"Записей нет"})})]})]})}}},function(e){e.O(0,[143,51,699,209,127,138,710,971,23,744],function(){return e(e.s=70082)}),_N_E=e.O()}]);
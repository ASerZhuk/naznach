(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[672],{14084:function(e,t,s){Promise.resolve().then(s.bind(s,92119)),Promise.resolve().then(s.bind(s,69168))},92119:function(e,t,s){"use strict";var r=s(57437);s(2265),t.default=e=>{let{children:t}=e;return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{className:"max-w-[2520px] min-h-screen mx-auto xl:px-20 md:px-10 sm:px-2 px-4",children:t})})}},69168:function(e,t,s){"use strict";var r,l,n=s(57437),a=s(92119),i=s(29057),c=s(89230),o=s(16463),d=s(2265),m=s(36463),u=s.n(m);s(54575),s(17062);var x=s(88788),p=s(3107),h=s(19675),f=s(16356),b=s(23580);s(44193);var j=s(3003);(0,m.registerLocale)("ru",c.ru),(r=l||(l={}))[r.DATE=0]="DATE",r[r.INFO=1]="INFO",r[r.CONF=2]="CONF",t.default=e=>{let t,{user:s,garfik:r}=e,l=(0,o.useRouter)(),[c,m]=(0,d.useState)(0),[g,N]=(0,d.useState)(null),[y,v]=(0,d.useState)([]),[w,O]=(0,d.useState)(null),[k,C]=(0,d.useState)(),[P,E]=(0,d.useState)({firstName:"",lastName:"",phone:""}),S=g?(0,x.WU)(g,"dd.MM.yyyy"):null,D=()=>{m(e=>e+1)},F=()=>{m(e=>e-1)};(0,d.useEffect)(()=>{var e;let t=window.Telegram.WebApp;t.ready();let l=null===(e=t.initDataUnsafe)||void 0===e?void 0:e.user;C(null==l?void 0:l.id),(async()=>{if(g){let e=g.getDay(),t=r.find(t=>t.dayOfWeek===e);if(t)try{let e=await fetch("/api/appointments?specialistId=".concat(null==s?void 0:s.userId,"&date=").concat(S));if(e.ok){let s=await e.json();if(Array.isArray(s)){let e=s.map(e=>e.time),r=t.time.filter(t=>!e.includes(t));v(r)}else console.error("Ответ от API не является массивом:",s),v([])}else console.error("Ошибка при загрузке записей"),v([])}catch(e){console.error("Ошибка при загрузке записей:",e),v([])}else v([])}})()},[g,r]);let I=e=>{O(e)},z=e=>{let{name:t,value:s}=e.target;E({...P,[t]:s})},_=async()=>{try{let e=await fetch("/api/appointments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firstName:P.firstName,lastName:P.lastName,phone:P.phone,specialistId:s.userId,clientId:null==k?void 0:k.toString(),date:S,time:w,specialistName:s.firstName,specialistLastName:s.lastName,specialistPhone:s.phone,specialistCategory:s.category,specialistAddress:s.address,specialistPrice:s.price})});if(!e.ok)throw Error("Ошибка при создании записи");let t=await e.json();console.log("Запись успешно создана:",t),b.Am.success("Запись прошла успешно"),l.push("/")}catch(e){console.error("Ошибка при создании записи:",e)}};return 0===c&&(t=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.xE,{onClick:()=>{l.back()}}),(0,n.jsx)(i.c7,{text:"Далее",onClick:D}),(0,n.jsxs)("div",{className:"flex-col bg-white rounded-lg shadow-md p-6 text-xl flex justify-center",children:[(0,n.jsxs)("div",{className:"border-b pb-4",children:[(0,n.jsx)("h2",{className:"text-xl font-normal mb-2",children:"Выбери дату и время"}),(0,n.jsx)("span",{className:"text-sm pb-2",children:"Выбери актуальную для тебя дату и время для записи на услугу"})]}),(0,n.jsx)("div",{className:"mt-4 flex justify-center",children:(0,n.jsx)(u(),{selected:g,onChange:e=>N(e),filterDate:e=>{let t=e.getDay();return r.some(e=>e.dayOfWeek===t)},minDate:new Date,maxDate:(0,p.z)(new Date,1),locale:"ru",inline:!0,className:"datepicker-custom"})}),g&&(0,n.jsx)("div",{className:"mt-4 p-6",children:(0,n.jsx)("div",{className:"grid grid-cols-4 gap-4 place-items-center text-sm",children:y.length>0?y.map((e,t)=>(0,n.jsx)("button",{onClick:()=>I(e),className:"px-3 py-2 rounded-full ".concat(w===e?"bg-blue-500 text-white":"bg-gray-200 hover:bg-gray-300"),children:e},t)):(0,n.jsx)("p",{children:"Нет доступного времени"})})})]})]})),1===c&&(t=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.xE,{onClick:F}),(0,n.jsx)(i.c7,{text:"Далее",onClick:D}),(0,n.jsxs)("div",{className:"max-w-md mx-auto bg-white shadow-md rounded-lg p-6",children:[(0,n.jsxs)("div",{className:" border-b pb-4 mb-4",children:[(0,n.jsx)("h2",{className:"text-xl font-normal mb-2",children:"Информация"}),(0,n.jsx)("span",{className:"text-sm",children:"Введи необходимые данные"})]}),(0,n.jsxs)("form",{children:[(0,n.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"firstName",children:"Имя"}),(0,n.jsx)("input",{id:"firstName",name:"firstName",type:"text",placeholder:"Введите имя",value:P.firstName,onChange:z,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline mb-6 text-sm"}),(0,n.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"lastName",children:"Фамилия"}),(0,n.jsx)("input",{id:"lastName",name:"lastName",type:"text",placeholder:"Введите фамилию",value:P.lastName,onChange:z,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline mb-6 text-sm"}),(0,n.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"phone",children:"Телефон"}),(0,n.jsx)("input",{id:"phone",name:"phone",type:"tel",placeholder:"Введите телефон",value:P.phone,onChange:z,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline text-sm"})]})]})]})),2===c&&(t=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.xE,{onClick:F}),(0,n.jsx)(i.c7,{text:"Записаться",onClick:_}),(0,n.jsxs)("div",{className:"flex flex-col bg-white rounded-lg shadow-md p-6 text-xl",children:[(0,n.jsx)(b.Ix,{}),(0,n.jsxs)("div",{className:" border-b pb-4 mb-4",children:[(0,n.jsx)("h2",{className:"text-xl font-normal mb-2",children:"Проверь данные"}),(0,n.jsx)("span",{className:"text-sm pb-4",children:"Если данные введены верно записывайся на услугу"})]}),(0,n.jsxs)("div",{className:"border-b flex items-center justify-between mt-4 p-2 text-sm",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(h.Mlo,{size:32,className:"bg-green-500 rounded-lg p-1",color:"white"}),(0,n.jsx)("span",{className:"ml-2 font-semibold",children:"Имя и Фамилия"})]}),(0,n.jsxs)("div",{children:[P.firstName," ",P.lastName]})]}),(0,n.jsxs)("div",{className:"border-b flex items-center justify-between mt-4 p-2 text-sm",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(f.X_f,{size:32,className:"bg-cyan-500 rounded-lg p-1",color:"white"}),(0,n.jsx)("span",{className:"ml-2 font-semibold",children:"Номер телефона"})]}),(0,n.jsx)("div",{children:P.phone})]}),(0,n.jsxs)("div",{className:"border-b flex items-center justify-between mt-4 p-2 text-sm",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(j.cZx,{size:32,className:"bg-red-500 rounded-lg p-1",color:"white"}),(0,n.jsx)("span",{className:"ml-2 font-semibold",children:"Дата записи"})]}),(0,n.jsx)("div",{children:S})]}),(0,n.jsxs)("div",{className:"border-b flex items-center justify-between mt-4 p-2 text-sm",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(f.Cl8,{size:32,className:"bg-orange-500 rounded-lg p-1",color:"white"}),(0,n.jsx)("span",{className:"ml-2 font-semibold",children:"Время записи"})]}),(0,n.jsx)("div",{children:w})]}),(0,n.jsxs)("div",{className:"border-b flex items-center justify-between mt-4 p-2 text-sm",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(h.R_H,{size:32,className:"bg-yellow-500 rounded-lg p-1",color:"white"}),(0,n.jsx)("span",{className:"ml-2 font-semibold",children:"Стоимость"})]}),(0,n.jsxs)("div",{children:[s.price," руб."]})]})]})]})),(0,n.jsx)(a.default,{children:(0,n.jsx)("div",{children:t})})}},17062:function(){},91810:function(e,t,s){"use strict";s.d(t,{w_:function(){return d}});var r=s(2265),l={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},n=r.createContext&&r.createContext(l),a=["attr","size","title"];function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e}).apply(this,arguments)}function c(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function o(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?c(Object(s),!0).forEach(function(t){var r,l;r=t,l=s[t],(r=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(r))in e?Object.defineProperty(e,r,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[r]=l}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):c(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function d(e){return t=>r.createElement(m,i({attr:o({},e.attr)},t),function e(t){return t&&t.map((t,s)=>r.createElement(t.tag,o({key:s},t.attr),e(t.child)))}(e.child))}function m(e){var t=t=>{var s,{attr:l,size:n,title:c}=e,d=function(e,t){if(null==e)return{};var s,r,l=function(e,t){if(null==e)return{};var s={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;s[r]=e[r]}return s}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)s=n[r],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(l[s]=e[s])}return l}(e,a),m=n||t.size||"1em";return t.className&&(s=t.className),e.className&&(s=(s?s+" ":"")+e.className),r.createElement("svg",i({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,l,d,{className:s,style:o(o({color:e.color||t.color},t.style),e.style),height:m,width:m,xmlns:"http://www.w3.org/2000/svg"}),c&&r.createElement("title",null,c),e.children)};return void 0!==n?r.createElement(n.Consumer,null,e=>t(e)):t(l)}}},function(e){e.O(0,[223,687,143,51,675,544,994,127,693,971,23,744],function(){return e(e.s=14084)}),_N_E=e.O()}]);